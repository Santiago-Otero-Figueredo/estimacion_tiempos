version: '3'

services: 
    db:
        image: postgres:12
        environment: 
            POSTGRES_PASSWORD: ejemplo
    web:
        build: .
        command: bash -c "python manage.py makemigrations && 
                            python manage.py migrate && 
                            python manage.py cargar_tipos_documentos &&
                            python manage.py cargar_tipos_usuarios &&
                            python manage.py cargar_usuarios &&
                            python manage.py cargar_estructuras &&
                            python manage.py runserver 0.0.0.0:8000"
        volumes: 
            - .:/aplicacion
        ports:
            - '8000:8000'
        depends_on: 
            - db
